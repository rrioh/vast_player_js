(()=>{"use strict";function e(e){let t=e.match(/(\d{2}):(\d{2}):(\d{2})/);if(!t||t.length<4||NaN===parseInt(t[1])||NaN===parseInt(t[2])||NaN===parseInt(t[3]))throw new Error("convertdurationToSecond error: "+e);return 60*parseInt(t[1])*60+60*parseInt(t[2])+parseFloat(t[3])}function t(e,t){if(!t)return;let r=new Date,n=document.createElement("img");n.src=t.replace(/\[TIMESTAMP\]/,r.toISOString()),n.style.display="none",e.prepend(n),console.log("[DEBUG] beacon sent: "+t)}function r(e,t){if(e)for(let r of e){let e=document.createElement("img");e.src=r.replace(/\[ERRORCODE\]/,t.toString()),e.style.display="none",document.body.prepend(e),console.log("[DEBUG] error beacon sent: "+r)}}var n;!function(e){e[e.XMLParseError=100]="XMLParseError",e[e.VASTSchemaValidationError=101]="VASTSchemaValidationError",e[e.VASTVersionOfResponseNotSupported=102]="VASTVersionOfResponseNotSupported",e[e.NonPlayableAdType=200]="NonPlayableAdType",e[e.MediaPlayerExpectingDifferentLinearity=201]="MediaPlayerExpectingDifferentLinearity",e[e.MediaPlayerExpectingDifferentDuration=202]="MediaPlayerExpectingDifferentDuration",e[e.MediaPlayerExpectingDifferentSize=203]="MediaPlayerExpectingDifferentSize",e[e.AdCategoryNotProvided=204]="AdCategoryNotProvided",e[e.InlineCategoryViolatesWrapperBlockedAdCategories=205]="InlineCategoryViolatesWrapperBlockedAdCategories",e[e.AdNotServed=206]="AdNotServed",e[e.GeneralWrapperError=300]="GeneralWrapperError",e[e.VASTURIUnavailableOrTimeout=301]="VASTURIUnavailableOrTimeout",e[e.WrapperLimitReached=302]="WrapperLimitReached",e[e.NoVASTResponseAfterWrapper=303]="NoVASTResponseAfterWrapper",e[e.AdUnitNotDisplayed=304]="AdUnitNotDisplayed",e[e.GeneralLinearError=400]="GeneralLinearError",e[e.FileNotFound=401]="FileNotFound",e[e.MediaFileURITimeout=402]="MediaFileURITimeout",e[e.SupportedMediaFileNotFound=403]="SupportedMediaFileNotFound",e[e.ProblemDisplayingMediaFile=405]="ProblemDisplayingMediaFile",e[e.MezzanineNotProvided=406]="MezzanineNotProvided",e[e.MezzanineDownloading=407]="MezzanineDownloading",e[e.ConditionalAdRejected=408]="ConditionalAdRejected",e[e.InteractiveUnitNotExecuted=409]="InteractiveUnitNotExecuted",e[e.VerificationUnitNotExecuted=410]="VerificationUnitNotExecuted",e[e.NotRequiredSpecificationOfMezzanine=411]="NotRequiredSpecificationOfMezzanine",e[e.GeneralNonLinearAdsError=500]="GeneralNonLinearAdsError",e[e.NonLinearAdNonDisplayable=501]="NonLinearAdNonDisplayable",e[e.UnableToFetchNonLinearResource=502]="UnableToFetchNonLinearResource",e[e.SupportedNonLinearResourceNotFound=503]="SupportedNonLinearResourceNotFound",e[e.GeneralCompanionAdsError=600]="GeneralCompanionAdsError",e[e.CompanionNonDisplayableByDimemsionError=601]="CompanionNonDisplayableByDimemsionError",e[e.RequiredCompanionNonDisplayable=602]="RequiredCompanionNonDisplayable",e[e.UnableToFetchNonCompanionResource=603]="UnableToFetchNonCompanionResource",e[e.SupportedCompanionResourceNotFound=604]="SupportedCompanionResourceNotFound",e[e.UndefinedError=900]="UndefinedError",e[e.GeneralVPAIDError=901]="GeneralVPAIDError",e[e.GeneralInteractiveCreativeFileError=902]="GeneralInteractiveCreativeFileError"}(n||(n={}));const i=new Map([["start",0],["firstQuartile",1/4],["midpoint",.5],["thirdQuartile",3/4],["complete",1]]),o=new class{errorUrls;constructor(){this.errorUrls=[]}parseVast(e){try{let t=this.parseVastXML(e);return this.createVastObject(t)}catch(e){return console.log("[ERROR] cannot create VASTObject: "+e),null}}parseVastXML(e){let t=(new DOMParser).parseFromString(e,"application/xml"),r=t.querySelector("parsererror");if(r)throw new Error(r.textContent||"parse vast error");let n=t.querySelector("VAST");if(!n)throw new Error("VAST tag not found");return n}createVastObject(t){const i=t.querySelector(":scope>Error");if(!i)throw new Error("cannot parse root Error");i.textContent&&this.errorUrls.push(i.textContent);const o=t.querySelector(":scope>Ad>InLine");if(!o)throw r(this.errorUrls,n.NoVASTResponseAfterWrapper),new Error("parse InLine error");const a=o.querySelector(":scope>Error");if(!a||!a.textContent)throw r(this.errorUrls,n.XMLParseError),new Error("parse InLine Error error");a.textContent&&this.errorUrls.push(a.textContent);const s=o.querySelector(":scope>Impression");if(!s||!s.textContent)throw r(this.errorUrls,n.XMLParseError),new Error("parse InLine Impression error");const l=s.textContent,c=o.querySelector(":scope>AdTitle");if(!c||!c.textContent)throw r(this.errorUrls,n.XMLParseError),new Error("parse InLine AdTitle error");const d=c.textContent,p=o.querySelector(":scope>Creatives>Creative>Linear");if(!p)throw r(this.errorUrls,n.XMLParseError),new Error("parse InLine Linear error");const u=p.querySelector(":scope>Duration");if(!u||!u.textContent)throw r(this.errorUrls,n.XMLParseError),new Error("parse InLine Linear Duration error");const h=e(u.textContent),T=p.querySelectorAll(":scope>TrackingEvents>Tracking"),m=this.createTrackingObject(T,h),g=p.querySelectorAll(":scope>Icons>Icon"),A=this.createIconObject(g),E=p.querySelectorAll(":scope>MediaFiles>MediaFile");if(!E)throw r(this.errorUrls,n.XMLParseError),new Error("parse MediaFiles error");const f=E[0]?.textContent,C=p.querySelector(":scope>VideoClicks>ClickThrough");if(!C||!C.textContent)throw r(this.errorUrls,n.XMLParseError),new Error("parse InLine Linear ClickThrough error");const y=C.textContent;return{errorUrls:this.errorUrls,impressionUrls:[l],adTitle:d,trackings:m,icons:A,mediaFileUrl:f,clickThroughUrl:y}}createTrackingObject(t,r){const n=new Map;return t.forEach((function(t){if(!t.textContent)return;const o=t.getAttribute("event");if(o)if("progress"===o){const r=t.getAttribute("offset");if(!r)return;const i=e(r);n.set(i,t.textContent)}else{const e=i.get(o);null!=e?n.set(e*r,t.textContent):n.set(o,t.textContent)}})),n}createIconObject(t){let r=[];for(let n of t){let t=n,i=parseInt(t.getAttribute("width")||"10")||10,o=parseInt(t.getAttribute("height")||"10")||10,a="0px",s=t.getAttribute("xPosition");s&&(a="left"===s||"right"===s?s:s+"px");let l="0px",c=t.getAttribute("yPosition");c&&(l="top"===c||"bottom"===c?c:c+"px");let d=t.getAttribute("offset"),p=0;d&&(p=e(d));let u=t.getAttribute("duration"),h=null;u&&(h=e(u)+p);const T=t.querySelector(":scope>StaticResource");if(!T||!T.textContent)continue;const m=t.querySelector(":scope>IconClicks>IconClickThrough"),g=t.querySelector(":scope>IconClicks>IconClickTracking");r.push({width:i,height:o,xPosition:a,yPosition:l,start:p,end:h,imgUrl:T.textContent,clickThroughtUrl:m?.textContent??null,clickTrackingUrl:g?.textContent??null})}return r}},a=new class{startPlayer(e){console.log("setPlayer started...");const r=o.parseVast('\n<VAST version="4.2">\n  <Error>\n    <![CDATA[http://test.example/error?code=[ERRORCODE]&clientTime=[TIMESTAMP]]]>\n  </Error>\n  <Ad id="1b330e59-3a62-4000-b9fb-ac9726e98c52" sequence="1">\n    <InLine>\n      <AdSystem version="2.0">nend</AdSystem>\n      <AdTitle><![CDATA[スマートフォンアドネットワーク「nend」]]></AdTitle>\n      <Description><![CDATA[静止画バナーから動画リワード/動画インターステイシャル/動画ネイティブに対応しています]]></Description>\n      <Advertiser><![CDATA[株式会社ファンコミュニケーションズ]]></Advertiser>\n      <Error><![CDATA[https://inline.test.example/error?code=[ERRORCODE]&clientTime=[TIMESTAMP]]]></Error>\n      <Impression id="nend"><![CDATA[https://inline.test.example/impression?clientTime=[TIMESTAMP]]]></Impression>\n      <Creatives>\n        <Creative adId="7245" sequence="1">\n          <Linear>\n            <Duration>00:00:15</Duration>\n            <MediaFiles>\n              <MediaFile delivery="progressive" type="video/mp4" width="1920" height="1080"><![CDATA[https://s3-ap-northeast-1.amazonaws.com/adstir-stage-js/video/AdStir-MOVIE-JP-15.mp4]]></MediaFile>\n            </MediaFiles>\n            <VideoClicks>\n              <ClickThrough><![CDATA[https://mt.united.jp?is=test]]></ClickThrough>\n              <ClickTracking><![CDATA[https://inline.test.example/videoclicktracking?clientTime=[TIMESTAMP]]]></ClickTracking>\n            </VideoClicks>\n            <Icons>\n              <Icon program="nend" width="10" height="10" xPosition="right" yPosition="top" offset="00:00:05" duration="00:00:06">\n                <StaticResource creativeType="image/png"><![CDATA[https://s3-ap-northeast-1.amazonaws.com/adstir-stage-js/optout/i1.png]]></StaticResource>\n                <IconClicks>\n                  <IconClickThrough><![CDATA[https://ja.ad-stir.com/sp/optout.html]]></IconClickThrough>\n                </IconClicks>\n              </Icon>\n            </Icons>\n            <TrackingEvents>\n              <Tracking event="pause"><![CDATA[https://inline.test.example/pause?clientTime=[TIMESTAMP]]]></Tracking>\n              <Tracking event="skip"><![CDATA[https://inline.test.example/skip?clientTime=[TIMESTAMP]]]></Tracking>\n              <Tracking event="start"><![CDATA[https://inline.test.example/start?clientTime=[TIMESTAMP]]]></Tracking>\n              <Tracking event="firstQuartile"><![CDATA[https://inline.test.example/firstQuartile?clientTime=[TIMESTAMP]]]></Tracking>\n              <Tracking event="midpoint"><![CDATA[https://inline.test.example/midpoint?clientTime=[TIMESTAMP]]]></Tracking>\n              <Tracking event="thirdQuartile"><![CDATA[https://inline.test.example/thirdQuartile?clientTime=[TIMESTAMP]]]></Tracking>\n              <Tracking event="complete"><![CDATA[https://inline.test.example/complete?clientTime=[TIMESTAMP]]]></Tracking>\n              <Tracking event="complete"><![CDATA[https://inline.test.example/complete2?clientTime=[TIMESTAMP]]]></Tracking>\n            </TrackingEvents>\n          </Linear>\n        </Creative>\n      </Creatives>\n    </InLine>\n  </Ad>\n</VAST>\n');if(!r)return;let n=document.createElement("iframe");n.width="300px",n.height="250px",n.style.border="none",document.getElementById("playerbox")?.appendChild(n);let i=n.contentWindow.document;i.open(),i.write('\n<!DOCTYPE html>\n<html>\n    <head>\n    </head>\n    <body style="margin:0;">\n        <div id="vast_video_container">\n            <div id="vast_video" style="width:300px;height:168.75px;"></div>\n            <div id="progress_bar" style="width:50%;height:2px;background-color:gray;"></div>\n            <div id="ad_title" style="margin:0;width:300px;height:77.25px;background-color:#dcdcdc;"></div>\n        </div>\n    </body>\n</html>\n'),i.close(),i.documentElement.style.overflow="hidden",i.getElementById("ad_title").textContent=r.adTitle;let a=i.getElementById("vast_video"),s=document.createElement("video");s.src=r.mediaFileUrl,s.style.width="100%",s.style.height="100%",s.muted=!0,s.autoplay=!0,s.addEventListener("loadedmetadata",(function(e){let t=i.getElementById("progress_bar"),r=function(){let e=s.currentTime/s.duration*100;t.style.width=e+"%",requestAnimationFrame(r)};requestAnimationFrame(r)})),function(e,r){!function(e,r){for(let n of r)e.addEventListener("canplay",(function(r){t(e,n)}),{once:!0})}(e,r.impressionUrls),function(e,t){e.addEventListener("click",(function(e){open(t,"_blank")}))}(e,r.clickThroughUrl),function(e,r){e.addEventListener("loadedmetadata",(function(n){for(let[n,i]of r.trackings)"pause"===n?e.addEventListener("pause",(function(r){t(e,i)})):"number"==typeof n&&e.addEventListener("timeupdate",(function r(o){e.currentTime>=n&&(t(e,i),e.removeEventListener("timeupdate",r))}))}))}(e,r)}(s,r),function(e,r,n){for(let i of n.icons){let n=document.createElement("img");n.src=i.imgUrl,n.width=i.width,n.height=i.height,n.style.position="fixed","left"===i.xPosition?n.style.left="0px":"right"===i.xPosition?n.style.right="0px":n.style.left=i.xPosition,"top"===i.yPosition?n.style.top="0px":"bottom"===i.yPosition?n.style.bottom="0px":n.style.top=i.yPosition,n.addEventListener("click",(function(r){i.clickTrackingUrl&&t(e,i.clickTrackingUrl),i.clickThroughtUrl&&open(i.clickThroughtUrl,"_blank")})),e.addEventListener("timeupdate",(function t(o){!r.contains(n)&&e.currentTime>=i.start&&r.appendChild(n),i.end&&r.contains(n)&&e.currentTime>=i.end&&(r.removeChild(n),e.removeEventListener("timeupdate",t))}))}}(s,a,r),a.appendChild(s)}};window.vastExecutor=window.vastExecutor||a})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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M0MsYUFBZTJDLE9BQU8zQyxjQUFnQkEsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3Zhc3RfcGxheWVyX2pzLy4vbGliL3V0aWwudHMiLCJ3ZWJwYWNrOi8vdmFzdF9wbGF5ZXJfanMvLi9saWIvYmVhY29uLnRzIiwid2VicGFjazovL3Zhc3RfcGxheWVyX2pzLy4vbGliL21hY3JvLnRzIiwid2VicGFjazovL3Zhc3RfcGxheWVyX2pzLy4vbGliL3Zhc3QudHMiLCJ3ZWJwYWNrOi8vdmFzdF9wbGF5ZXJfanMvLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly92YXN0X3BsYXllcl9qcy8uL2xpYi9pY29uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0VGltZVRvU2Vjb25kKGR1cmF0aW9uU3RyKSB7XG4gICAgbGV0IHJlc3VsdCA9IGR1cmF0aW9uU3RyLm1hdGNoKC8oXFxkezJ9KTooXFxkezJ9KTooXFxkezJ9KS8pO1xuICAgIGlmICghcmVzdWx0IHx8IHJlc3VsdC5sZW5ndGggPCA0IHx8IHBhcnNlSW50KHJlc3VsdFsxXSkgPT09IE5hTiB8fCBwYXJzZUludChyZXN1bHRbMl0pID09PSBOYU4gfHwgcGFyc2VJbnQocmVzdWx0WzNdKSA9PT0gTmFOKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImNvbnZlcnRkdXJhdGlvblRvU2Vjb25kIGVycm9yOiBcIiArIGR1cmF0aW9uU3RyKTtcbiAgICB9XG4gICAgcmV0dXJuIHBhcnNlSW50KHJlc3VsdFsxXSkgKiA2MCAqIDYwICsgcGFyc2VJbnQocmVzdWx0WzJdKSAqIDYwICsgcGFyc2VGbG9hdChyZXN1bHRbM10pO1xufVxuIiwiZnVuY3Rpb24gc2V0SW1wcmVzc2lvblVybCh2aWRlbywgdXJscykge1xuICAgIGZvciAobGV0IHVybCBvZiB1cmxzKSB7XG4gICAgICAgIHZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJjYW5wbGF5XCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBjcmVhdGVCZWFjb24odmlkZW8sIHVybCk7XG4gICAgICAgIH0sIHsgb25jZTogdHJ1ZSB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRWaWRlb0NsaWNrVGhyb3VnaFVybCh2aWRlbywgdXJsKSB7XG4gICAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIG9wZW4odXJsLCBcIl9ibGFua1wiKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHNldFRyYWNraW5nVXJscyh2aWRlbywgdmFzdE9iamVjdCkge1xuICAgIHZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkZWRtZXRhZGF0YVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBmb3IgKGxldCBbcG9pbnQsIHVybF0gb2YgdmFzdE9iamVjdC50cmFja2luZ3MpIHtcbiAgICAgICAgICAgIGlmIChwb2ludCA9PT0gXCJwYXVzZVwiKSB7XG4gICAgICAgICAgICAgICAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcInBhdXNlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUJlYWNvbih2aWRlbywgdXJsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBwb2ludCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIHZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJ0aW1ldXBkYXRlXCIsIGZ1bmN0aW9uIHRpbWVCZWFjb25FdmVudChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWRlby5jdXJyZW50VGltZSA+PSBwb2ludCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlQmVhY29uKHZpZGVvLCB1cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRpbWV1cGRhdGVcIiwgdGltZUJlYWNvbkV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQmVhY29uKHBhcmVudCwgdXJsKSB7XG4gICAgaWYgKCF1cmwpXG4gICAgICAgIHJldHVybjtcbiAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgbGV0IGVsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XG4gICAgZWxlLnNyYyA9IHVybC5yZXBsYWNlKC9cXFtUSU1FU1RBTVBcXF0vLCBkYXRlLnRvSVNPU3RyaW5nKCkpO1xuICAgIGVsZS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgcGFyZW50LnByZXBlbmQoZWxlKTtcbiAgICBjb25zb2xlLmxvZyhcIltERUJVR10gYmVhY29uIHNlbnQ6IFwiICsgdXJsKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZW5kRXJyb3IodXJscywgZXJyb3JDb2RlKSB7XG4gICAgaWYgKCF1cmxzKVxuICAgICAgICByZXR1cm47XG4gICAgZm9yIChsZXQgdXJsIG9mIHVybHMpIHtcbiAgICAgICAgbGV0IGVsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XG4gICAgICAgIGVsZS5zcmMgPSB1cmwucmVwbGFjZSgvXFxbRVJST1JDT0RFXFxdLywgZXJyb3JDb2RlLnRvU3RyaW5nKCkpO1xuICAgICAgICBlbGUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICBkb2N1bWVudC5ib2R5LnByZXBlbmQoZWxlKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJbREVCVUddIGVycm9yIGJlYWNvbiBzZW50OiBcIiArIHVybCk7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIHNldEJlYWNvbnModmlkZW8sIHZhc3RPYmplY3QpIHtcbiAgICBzZXRJbXByZXNzaW9uVXJsKHZpZGVvLCB2YXN0T2JqZWN0LmltcHJlc3Npb25VcmxzKTtcbiAgICBzZXRWaWRlb0NsaWNrVGhyb3VnaFVybCh2aWRlbywgdmFzdE9iamVjdC5jbGlja1Rocm91Z2hVcmwpO1xuICAgIHNldFRyYWNraW5nVXJscyh2aWRlbywgdmFzdE9iamVjdCk7XG59XG4iLCJleHBvcnQgdmFyIEVycm9yQ29kZTtcbihmdW5jdGlvbiAoRXJyb3JDb2RlKSB7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIlhNTFBhcnNlRXJyb3JcIl0gPSAxMDBdID0gXCJYTUxQYXJzZUVycm9yXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIlZBU1RTY2hlbWFWYWxpZGF0aW9uRXJyb3JcIl0gPSAxMDFdID0gXCJWQVNUU2NoZW1hVmFsaWRhdGlvbkVycm9yXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIlZBU1RWZXJzaW9uT2ZSZXNwb25zZU5vdFN1cHBvcnRlZFwiXSA9IDEwMl0gPSBcIlZBU1RWZXJzaW9uT2ZSZXNwb25zZU5vdFN1cHBvcnRlZFwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJOb25QbGF5YWJsZUFkVHlwZVwiXSA9IDIwMF0gPSBcIk5vblBsYXlhYmxlQWRUeXBlXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIk1lZGlhUGxheWVyRXhwZWN0aW5nRGlmZmVyZW50TGluZWFyaXR5XCJdID0gMjAxXSA9IFwiTWVkaWFQbGF5ZXJFeHBlY3RpbmdEaWZmZXJlbnRMaW5lYXJpdHlcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiTWVkaWFQbGF5ZXJFeHBlY3RpbmdEaWZmZXJlbnREdXJhdGlvblwiXSA9IDIwMl0gPSBcIk1lZGlhUGxheWVyRXhwZWN0aW5nRGlmZmVyZW50RHVyYXRpb25cIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiTWVkaWFQbGF5ZXJFeHBlY3RpbmdEaWZmZXJlbnRTaXplXCJdID0gMjAzXSA9IFwiTWVkaWFQbGF5ZXJFeHBlY3RpbmdEaWZmZXJlbnRTaXplXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIkFkQ2F0ZWdvcnlOb3RQcm92aWRlZFwiXSA9IDIwNF0gPSBcIkFkQ2F0ZWdvcnlOb3RQcm92aWRlZFwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJJbmxpbmVDYXRlZ29yeVZpb2xhdGVzV3JhcHBlckJsb2NrZWRBZENhdGVnb3JpZXNcIl0gPSAyMDVdID0gXCJJbmxpbmVDYXRlZ29yeVZpb2xhdGVzV3JhcHBlckJsb2NrZWRBZENhdGVnb3JpZXNcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiQWROb3RTZXJ2ZWRcIl0gPSAyMDZdID0gXCJBZE5vdFNlcnZlZFwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJHZW5lcmFsV3JhcHBlckVycm9yXCJdID0gMzAwXSA9IFwiR2VuZXJhbFdyYXBwZXJFcnJvclwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJWQVNUVVJJVW5hdmFpbGFibGVPclRpbWVvdXRcIl0gPSAzMDFdID0gXCJWQVNUVVJJVW5hdmFpbGFibGVPclRpbWVvdXRcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiV3JhcHBlckxpbWl0UmVhY2hlZFwiXSA9IDMwMl0gPSBcIldyYXBwZXJMaW1pdFJlYWNoZWRcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiTm9WQVNUUmVzcG9uc2VBZnRlcldyYXBwZXJcIl0gPSAzMDNdID0gXCJOb1ZBU1RSZXNwb25zZUFmdGVyV3JhcHBlclwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJBZFVuaXROb3REaXNwbGF5ZWRcIl0gPSAzMDRdID0gXCJBZFVuaXROb3REaXNwbGF5ZWRcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiR2VuZXJhbExpbmVhckVycm9yXCJdID0gNDAwXSA9IFwiR2VuZXJhbExpbmVhckVycm9yXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIkZpbGVOb3RGb3VuZFwiXSA9IDQwMV0gPSBcIkZpbGVOb3RGb3VuZFwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJNZWRpYUZpbGVVUklUaW1lb3V0XCJdID0gNDAyXSA9IFwiTWVkaWFGaWxlVVJJVGltZW91dFwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJTdXBwb3J0ZWRNZWRpYUZpbGVOb3RGb3VuZFwiXSA9IDQwM10gPSBcIlN1cHBvcnRlZE1lZGlhRmlsZU5vdEZvdW5kXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIlByb2JsZW1EaXNwbGF5aW5nTWVkaWFGaWxlXCJdID0gNDA1XSA9IFwiUHJvYmxlbURpc3BsYXlpbmdNZWRpYUZpbGVcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiTWV6emFuaW5lTm90UHJvdmlkZWRcIl0gPSA0MDZdID0gXCJNZXp6YW5pbmVOb3RQcm92aWRlZFwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJNZXp6YW5pbmVEb3dubG9hZGluZ1wiXSA9IDQwN10gPSBcIk1lenphbmluZURvd25sb2FkaW5nXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIkNvbmRpdGlvbmFsQWRSZWplY3RlZFwiXSA9IDQwOF0gPSBcIkNvbmRpdGlvbmFsQWRSZWplY3RlZFwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJJbnRlcmFjdGl2ZVVuaXROb3RFeGVjdXRlZFwiXSA9IDQwOV0gPSBcIkludGVyYWN0aXZlVW5pdE5vdEV4ZWN1dGVkXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIlZlcmlmaWNhdGlvblVuaXROb3RFeGVjdXRlZFwiXSA9IDQxMF0gPSBcIlZlcmlmaWNhdGlvblVuaXROb3RFeGVjdXRlZFwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJOb3RSZXF1aXJlZFNwZWNpZmljYXRpb25PZk1lenphbmluZVwiXSA9IDQxMV0gPSBcIk5vdFJlcXVpcmVkU3BlY2lmaWNhdGlvbk9mTWV6emFuaW5lXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIkdlbmVyYWxOb25MaW5lYXJBZHNFcnJvclwiXSA9IDUwMF0gPSBcIkdlbmVyYWxOb25MaW5lYXJBZHNFcnJvclwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJOb25MaW5lYXJBZE5vbkRpc3BsYXlhYmxlXCJdID0gNTAxXSA9IFwiTm9uTGluZWFyQWROb25EaXNwbGF5YWJsZVwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJVbmFibGVUb0ZldGNoTm9uTGluZWFyUmVzb3VyY2VcIl0gPSA1MDJdID0gXCJVbmFibGVUb0ZldGNoTm9uTGluZWFyUmVzb3VyY2VcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiU3VwcG9ydGVkTm9uTGluZWFyUmVzb3VyY2VOb3RGb3VuZFwiXSA9IDUwM10gPSBcIlN1cHBvcnRlZE5vbkxpbmVhclJlc291cmNlTm90Rm91bmRcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiR2VuZXJhbENvbXBhbmlvbkFkc0Vycm9yXCJdID0gNjAwXSA9IFwiR2VuZXJhbENvbXBhbmlvbkFkc0Vycm9yXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIkNvbXBhbmlvbk5vbkRpc3BsYXlhYmxlQnlEaW1lbXNpb25FcnJvclwiXSA9IDYwMV0gPSBcIkNvbXBhbmlvbk5vbkRpc3BsYXlhYmxlQnlEaW1lbXNpb25FcnJvclwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJSZXF1aXJlZENvbXBhbmlvbk5vbkRpc3BsYXlhYmxlXCJdID0gNjAyXSA9IFwiUmVxdWlyZWRDb21wYW5pb25Ob25EaXNwbGF5YWJsZVwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJVbmFibGVUb0ZldGNoTm9uQ29tcGFuaW9uUmVzb3VyY2VcIl0gPSA2MDNdID0gXCJVbmFibGVUb0ZldGNoTm9uQ29tcGFuaW9uUmVzb3VyY2VcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiU3VwcG9ydGVkQ29tcGFuaW9uUmVzb3VyY2VOb3RGb3VuZFwiXSA9IDYwNF0gPSBcIlN1cHBvcnRlZENvbXBhbmlvblJlc291cmNlTm90Rm91bmRcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiVW5kZWZpbmVkRXJyb3JcIl0gPSA5MDBdID0gXCJVbmRlZmluZWRFcnJvclwiO1xuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJHZW5lcmFsVlBBSURFcnJvclwiXSA9IDkwMV0gPSBcIkdlbmVyYWxWUEFJREVycm9yXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIkdlbmVyYWxJbnRlcmFjdGl2ZUNyZWF0aXZlRmlsZUVycm9yXCJdID0gOTAyXSA9IFwiR2VuZXJhbEludGVyYWN0aXZlQ3JlYXRpdmVGaWxlRXJyb3JcIjtcbn0pKEVycm9yQ29kZSB8fCAoRXJyb3JDb2RlID0ge30pKTtcbiIsImltcG9ydCB7IGNvbnZlcnRUaW1lVG9TZWNvbmQgfSBmcm9tIFwiLi91dGlsXCI7XG5pbXBvcnQgeyBzZW5kRXJyb3IgfSBmcm9tIFwiLi9iZWFjb25cIjtcbmltcG9ydCB7IEVycm9yQ29kZSB9IGZyb20gXCIuL21hY3JvXCI7XG5jb25zdCBUUkFDS0lOR19FVkVOVF9QT0lOVCA9IG5ldyBNYXAoW1xuICAgIFtcInN0YXJ0XCIsIDBdLFxuICAgIFtcImZpcnN0UXVhcnRpbGVcIiwgMSAvIDRdLFxuICAgIFtcIm1pZHBvaW50XCIsIDEgLyAyXSxcbiAgICBbXCJ0aGlyZFF1YXJ0aWxlXCIsIDMgLyA0XSxcbiAgICBbXCJjb21wbGV0ZVwiLCAxXVxuXSk7XG5jbGFzcyBWYXN0IHtcbiAgICBlcnJvclVybHM7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZXJyb3JVcmxzID0gW107XG4gICAgfVxuICAgIHBhcnNlVmFzdChzb3VyY2VWYXN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgdmFzdERvYyA9IHRoaXMucGFyc2VWYXN0WE1MKHNvdXJjZVZhc3QpO1xuICAgICAgICAgICAgbGV0IHZhc3RPYmplY3QgPSB0aGlzLmNyZWF0ZVZhc3RPYmplY3QodmFzdERvYyk7XG4gICAgICAgICAgICByZXR1cm4gdmFzdE9iamVjdDtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJbRVJST1JdIGNhbm5vdCBjcmVhdGUgVkFTVE9iamVjdDogXCIgKyBlKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIHBhcnNlVmFzdFhNTChzb3VyY2VWYXN0KSB7XG4gICAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcbiAgICAgICAgbGV0IHhtbERvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoc291cmNlVmFzdCwgXCJhcHBsaWNhdGlvbi94bWxcIik7XG4gICAgICAgIGxldCBwYXJzZXJFcnJvciA9IHhtbERvYy5xdWVyeVNlbGVjdG9yKFwicGFyc2VyZXJyb3JcIik7XG4gICAgICAgIGlmIChwYXJzZXJFcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHBhcnNlckVycm9yLnRleHRDb250ZW50IHx8IFwicGFyc2UgdmFzdCBlcnJvclwiKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgdmFzdERvYyA9IHhtbERvYy5xdWVyeVNlbGVjdG9yKFwiVkFTVFwiKTtcbiAgICAgICAgaWYgKCF2YXN0RG9jKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWQVNUIHRhZyBub3QgZm91bmRcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhc3REb2M7XG4gICAgfVxuICAgIGNyZWF0ZVZhc3RPYmplY3QodmRvYykge1xuICAgICAgICBjb25zdCByb290RXJyb3JEb2MgPSB2ZG9jLnF1ZXJ5U2VsZWN0b3IoXCI6c2NvcGU+RXJyb3JcIik7XG4gICAgICAgIGlmICghcm9vdEVycm9yRG9jKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYW5ub3QgcGFyc2Ugcm9vdCBFcnJvclwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm9vdEVycm9yRG9jLnRleHRDb250ZW50KVxuICAgICAgICAgICAgdGhpcy5lcnJvclVybHMucHVzaChyb290RXJyb3JEb2MudGV4dENvbnRlbnQpO1xuICAgICAgICBjb25zdCBpbmxpbmVEb2MgPSB2ZG9jLnF1ZXJ5U2VsZWN0b3IoXCI6c2NvcGU+QWQ+SW5MaW5lXCIpO1xuICAgICAgICBpZiAoIWlubGluZURvYykge1xuICAgICAgICAgICAgc2VuZEVycm9yKHRoaXMuZXJyb3JVcmxzLCBFcnJvckNvZGUuTm9WQVNUUmVzcG9uc2VBZnRlcldyYXBwZXIpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwicGFyc2UgSW5MaW5lIGVycm9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVycm9yRG9jID0gaW5saW5lRG9jLnF1ZXJ5U2VsZWN0b3IoXCI6c2NvcGU+RXJyb3JcIik7XG4gICAgICAgIGlmICghZXJyb3JEb2MgfHwgIWVycm9yRG9jLnRleHRDb250ZW50KSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IodGhpcy5lcnJvclVybHMsIEVycm9yQ29kZS5YTUxQYXJzZUVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInBhcnNlIEluTGluZSBFcnJvciBlcnJvclwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXJyb3JEb2MudGV4dENvbnRlbnQpXG4gICAgICAgICAgICB0aGlzLmVycm9yVXJscy5wdXNoKGVycm9yRG9jLnRleHRDb250ZW50KTtcbiAgICAgICAgY29uc3QgaW1wRG9jID0gaW5saW5lRG9jLnF1ZXJ5U2VsZWN0b3IoXCI6c2NvcGU+SW1wcmVzc2lvblwiKTtcbiAgICAgICAgaWYgKCFpbXBEb2MgfHwgIWltcERvYy50ZXh0Q29udGVudCkge1xuICAgICAgICAgICAgc2VuZEVycm9yKHRoaXMuZXJyb3JVcmxzLCBFcnJvckNvZGUuWE1MUGFyc2VFcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJwYXJzZSBJbkxpbmUgSW1wcmVzc2lvbiBlcnJvclwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbXByZXNzaW9uVXJsID0gaW1wRG9jLnRleHRDb250ZW50O1xuICAgICAgICBjb25zdCBhZFRpdGxlRG9jID0gaW5saW5lRG9jLnF1ZXJ5U2VsZWN0b3IoXCI6c2NvcGU+QWRUaXRsZVwiKTtcbiAgICAgICAgaWYgKCFhZFRpdGxlRG9jIHx8ICFhZFRpdGxlRG9jLnRleHRDb250ZW50KSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IodGhpcy5lcnJvclVybHMsIEVycm9yQ29kZS5YTUxQYXJzZUVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInBhcnNlIEluTGluZSBBZFRpdGxlIGVycm9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFkVGl0bGUgPSBhZFRpdGxlRG9jLnRleHRDb250ZW50O1xuICAgICAgICBjb25zdCBsaW5lYXJEb2MgPSBpbmxpbmVEb2MucXVlcnlTZWxlY3RvcihcIjpzY29wZT5DcmVhdGl2ZXM+Q3JlYXRpdmU+TGluZWFyXCIpO1xuICAgICAgICBpZiAoIWxpbmVhckRvYykge1xuICAgICAgICAgICAgc2VuZEVycm9yKHRoaXMuZXJyb3JVcmxzLCBFcnJvckNvZGUuWE1MUGFyc2VFcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJwYXJzZSBJbkxpbmUgTGluZWFyIGVycm9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGR1cmF0aW9uRG9jID0gbGluZWFyRG9jLnF1ZXJ5U2VsZWN0b3IoXCI6c2NvcGU+RHVyYXRpb25cIik7XG4gICAgICAgIGlmICghZHVyYXRpb25Eb2MgfHwgIWR1cmF0aW9uRG9jLnRleHRDb250ZW50KSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IodGhpcy5lcnJvclVybHMsIEVycm9yQ29kZS5YTUxQYXJzZUVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInBhcnNlIEluTGluZSBMaW5lYXIgRHVyYXRpb24gZXJyb3JcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBjb252ZXJ0VGltZVRvU2Vjb25kKGR1cmF0aW9uRG9jLnRleHRDb250ZW50KTtcbiAgICAgICAgY29uc3QgdHJhY2tpbmdzRG9jID0gbGluZWFyRG9jLnF1ZXJ5U2VsZWN0b3JBbGwoXCI6c2NvcGU+VHJhY2tpbmdFdmVudHM+VHJhY2tpbmdcIik7XG4gICAgICAgIGNvbnN0IHRyYWNraW5nTWFwID0gdGhpcy5jcmVhdGVUcmFja2luZ09iamVjdCh0cmFja2luZ3NEb2MsIGR1cmF0aW9uKTtcbiAgICAgICAgY29uc3QgaWNvbnNEb2MgPSBsaW5lYXJEb2MucXVlcnlTZWxlY3RvckFsbChcIjpzY29wZT5JY29ucz5JY29uXCIpO1xuICAgICAgICBjb25zdCBpY29uT2JqZWN0cyA9IHRoaXMuY3JlYXRlSWNvbk9iamVjdChpY29uc0RvYyk7XG4gICAgICAgIGNvbnN0IG1lZGlhRmlsZXNEb2MgPSBsaW5lYXJEb2MucXVlcnlTZWxlY3RvckFsbChcIjpzY29wZT5NZWRpYUZpbGVzPk1lZGlhRmlsZVwiKTtcbiAgICAgICAgaWYgKCFtZWRpYUZpbGVzRG9jKSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IodGhpcy5lcnJvclVybHMsIEVycm9yQ29kZS5YTUxQYXJzZUVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInBhcnNlIE1lZGlhRmlsZXMgZXJyb3JcIik7XG4gICAgICAgIH1cbiAgICAgICAgLy8g44Gy44Go44G+44GaMeOBpOebruOBrk1lZGlhRmlsZeOBrlVSTOOBruOBv+WPluW+l1xuICAgICAgICBjb25zdCBtZWRpYUZpbGVVcmwgPSBtZWRpYUZpbGVzRG9jWzBdPy50ZXh0Q29udGVudDtcbiAgICAgICAgY29uc3QgY2xpY2tUaHJvdWdoRG9jID0gbGluZWFyRG9jLnF1ZXJ5U2VsZWN0b3IoXCI6c2NvcGU+VmlkZW9DbGlja3M+Q2xpY2tUaHJvdWdoXCIpO1xuICAgICAgICBpZiAoIWNsaWNrVGhyb3VnaERvYyB8fCAhY2xpY2tUaHJvdWdoRG9jLnRleHRDb250ZW50KSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IodGhpcy5lcnJvclVybHMsIEVycm9yQ29kZS5YTUxQYXJzZUVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInBhcnNlIEluTGluZSBMaW5lYXIgQ2xpY2tUaHJvdWdoIGVycm9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNsaWNrVGhyb3VnaFVybCA9IGNsaWNrVGhyb3VnaERvYy50ZXh0Q29udGVudDtcbiAgICAgICAgY29uc3QgdmFzdE9iamVjdCA9IHtcbiAgICAgICAgICAgIGVycm9yVXJsczogdGhpcy5lcnJvclVybHMsXG4gICAgICAgICAgICBpbXByZXNzaW9uVXJsczogW2ltcHJlc3Npb25VcmxdLFxuICAgICAgICAgICAgYWRUaXRsZTogYWRUaXRsZSxcbiAgICAgICAgICAgIHRyYWNraW5nczogdHJhY2tpbmdNYXAsXG4gICAgICAgICAgICBpY29uczogaWNvbk9iamVjdHMsXG4gICAgICAgICAgICBtZWRpYUZpbGVVcmw6IG1lZGlhRmlsZVVybCxcbiAgICAgICAgICAgIGNsaWNrVGhyb3VnaFVybDogY2xpY2tUaHJvdWdoVXJsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB2YXN0T2JqZWN0O1xuICAgIH1cbiAgICBjcmVhdGVUcmFja2luZ09iamVjdCh0cmFja2luZ3NEb2MsIGR1cmF0aW9uKSB7XG4gICAgICAgIGNvbnN0IHRyYWNraW5nTWFwID0gbmV3IE1hcCgpO1xuICAgICAgICB0cmFja2luZ3NEb2MuZm9yRWFjaChmdW5jdGlvbiAodHJhY2tpbmcpIHtcbiAgICAgICAgICAgIGlmICghdHJhY2tpbmcudGV4dENvbnRlbnQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSB0cmFja2luZy5nZXRBdHRyaWJ1dGUoXCJldmVudFwiKTtcbiAgICAgICAgICAgIGlmICghZXZlbnQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKGV2ZW50ID09PSBcInByb2dyZXNzXCIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvZmZzZXQgPSB0cmFja2luZy5nZXRBdHRyaWJ1dGUoXCJvZmZzZXRcIik7XG4gICAgICAgICAgICAgICAgaWYgKCFvZmZzZXQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBjb25zdCBvZmZzZXRTZWNvbmQgPSBjb252ZXJ0VGltZVRvU2Vjb25kKG9mZnNldCk7XG4gICAgICAgICAgICAgICAgdHJhY2tpbmdNYXAuc2V0KG9mZnNldFNlY29uZCwgdHJhY2tpbmcudGV4dENvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXZlbnRfcG9pbnQgPSBUUkFDS0lOR19FVkVOVF9QT0lOVC5nZXQoZXZlbnQpO1xuICAgICAgICAgICAgICAgIGlmIChldmVudF9wb2ludCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tpbmdNYXAuc2V0KGV2ZW50X3BvaW50ICogZHVyYXRpb24sIHRyYWNraW5nLnRleHRDb250ZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNraW5nTWFwLnNldChldmVudCwgdHJhY2tpbmcudGV4dENvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0cmFja2luZ01hcDtcbiAgICB9XG4gICAgY3JlYXRlSWNvbk9iamVjdChpY29uc0RvYykge1xuICAgICAgICBsZXQgaWNvbk9iamVjdHMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaWNvbiBvZiBpY29uc0RvYykge1xuICAgICAgICAgICAgbGV0IGljb25FbGUgPSBpY29uO1xuICAgICAgICAgICAgbGV0IHdpZHRoID0gcGFyc2VJbnQoaWNvbkVsZS5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSB8fCBcIjEwXCIpIHx8IDEwO1xuICAgICAgICAgICAgbGV0IGhlaWdodCA9IHBhcnNlSW50KGljb25FbGUuZ2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIpIHx8IFwiMTBcIikgfHwgMTA7XG4gICAgICAgICAgICBsZXQgeCA9IFwiMHB4XCI7XG4gICAgICAgICAgICBsZXQgeFBvc2l0aW9uID0gaWNvbkVsZS5nZXRBdHRyaWJ1dGUoXCJ4UG9zaXRpb25cIik7XG4gICAgICAgICAgICBpZiAoeFBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHhQb3NpdGlvbiA9PT0gXCJsZWZ0XCIgfHwgeFBvc2l0aW9uID09PSBcInJpZ2h0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgeCA9IHhQb3NpdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHggPSB4UG9zaXRpb24gKyBcInB4XCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHkgPSBcIjBweFwiO1xuICAgICAgICAgICAgbGV0IHlQb3NpdGlvbiA9IGljb25FbGUuZ2V0QXR0cmlidXRlKFwieVBvc2l0aW9uXCIpO1xuICAgICAgICAgICAgaWYgKHlQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIGlmICh5UG9zaXRpb24gPT09IFwidG9wXCIgfHwgeVBvc2l0aW9uID09PSBcImJvdHRvbVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHkgPSB5UG9zaXRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB5ID0geVBvc2l0aW9uICsgXCJweFwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBvZmZzZXQgPSBpY29uRWxlLmdldEF0dHJpYnV0ZShcIm9mZnNldFwiKTtcbiAgICAgICAgICAgIGxldCBzdGFydCA9IDA7XG4gICAgICAgICAgICBpZiAob2Zmc2V0KVxuICAgICAgICAgICAgICAgIHN0YXJ0ID0gY29udmVydFRpbWVUb1NlY29uZChvZmZzZXQpO1xuICAgICAgICAgICAgbGV0IGR1cmF0aW9uID0gaWNvbkVsZS5nZXRBdHRyaWJ1dGUoXCJkdXJhdGlvblwiKTtcbiAgICAgICAgICAgIGxldCBlbmQgPSBudWxsO1xuICAgICAgICAgICAgaWYgKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgIGVuZCA9IGNvbnZlcnRUaW1lVG9TZWNvbmQoZHVyYXRpb24pICsgc3RhcnQ7XG4gICAgICAgICAgICBjb25zdCBzdGF0aWNSZXNvdXJjZSA9IGljb25FbGUucXVlcnlTZWxlY3RvcihcIjpzY29wZT5TdGF0aWNSZXNvdXJjZVwiKTtcbiAgICAgICAgICAgIGlmICghc3RhdGljUmVzb3VyY2UgfHwgIXN0YXRpY1Jlc291cmNlLnRleHRDb250ZW50KVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgY29uc3QgaWNvbkNsaWNrVGhyb3VnaCA9IGljb25FbGUucXVlcnlTZWxlY3RvcihcIjpzY29wZT5JY29uQ2xpY2tzPkljb25DbGlja1Rocm91Z2hcIik7XG4gICAgICAgICAgICBjb25zdCBpY29uQ2xpY2tUcmFja2luZyA9IGljb25FbGUucXVlcnlTZWxlY3RvcihcIjpzY29wZT5JY29uQ2xpY2tzPkljb25DbGlja1RyYWNraW5nXCIpO1xuICAgICAgICAgICAgaWNvbk9iamVjdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgICAgICAgICAgICAgIHhQb3NpdGlvbjogeCxcbiAgICAgICAgICAgICAgICB5UG9zaXRpb246IHksXG4gICAgICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0LFxuICAgICAgICAgICAgICAgIGVuZDogZW5kLFxuICAgICAgICAgICAgICAgIGltZ1VybDogc3RhdGljUmVzb3VyY2UudGV4dENvbnRlbnQsXG4gICAgICAgICAgICAgICAgY2xpY2tUaHJvdWdodFVybDogaWNvbkNsaWNrVGhyb3VnaD8udGV4dENvbnRlbnQgPz8gbnVsbCxcbiAgICAgICAgICAgICAgICBjbGlja1RyYWNraW5nVXJsOiBpY29uQ2xpY2tUcmFja2luZz8udGV4dENvbnRlbnQgPz8gbnVsbFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGljb25PYmplY3RzO1xuICAgIH1cbn1cbmNvbnN0IHZhc3QgPSBuZXcgVmFzdCgpO1xuZXhwb3J0IGRlZmF1bHQgdmFzdDtcbiIsImltcG9ydCB2YXN0IGZyb20gXCIuLi9saWIvdmFzdFwiO1xuaW1wb3J0IHsgc2V0QmVhY29ucyB9IGZyb20gXCIuLi9saWIvYmVhY29uXCI7XG5pbXBvcnQgeyBzZXRJY29ucyB9IGZyb20gXCIuLi9saWIvaWNvblwiO1xuY29uc3QgY29udGFpbmVyID0gYFxuPCFET0NUWVBFIGh0bWw+XG48aHRtbD5cbiAgICA8aGVhZD5cbiAgICA8L2hlYWQ+XG4gICAgPGJvZHkgc3R5bGU9XCJtYXJnaW46MDtcIj5cbiAgICAgICAgPGRpdiBpZD1cInZhc3RfdmlkZW9fY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGlkPVwidmFzdF92aWRlb1wiIHN0eWxlPVwid2lkdGg6MzAwcHg7aGVpZ2h0OjE2OC43NXB4O1wiPjwvZGl2PlxuICAgICAgICAgICAgPGRpdiBpZD1cInByb2dyZXNzX2JhclwiIHN0eWxlPVwid2lkdGg6NTAlO2hlaWdodDoycHg7YmFja2dyb3VuZC1jb2xvcjpncmF5O1wiPjwvZGl2PlxuICAgICAgICAgICAgPGRpdiBpZD1cImFkX3RpdGxlXCIgc3R5bGU9XCJtYXJnaW46MDt3aWR0aDozMDBweDtoZWlnaHQ6NzcuMjVweDtiYWNrZ3JvdW5kLWNvbG9yOiNkY2RjZGM7XCI+PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvYm9keT5cbjwvaHRtbD5cbmA7XG5jb25zdCBpbmxpbmVWYXN0U2FtcGxlID0gYFxuPFZBU1QgdmVyc2lvbj1cIjQuMlwiPlxuICA8RXJyb3I+XG4gICAgPCFbQ0RBVEFbaHR0cDovL3Rlc3QuZXhhbXBsZS9lcnJvcj9jb2RlPVtFUlJPUkNPREVdJmNsaWVudFRpbWU9W1RJTUVTVEFNUF1dXT5cbiAgPC9FcnJvcj5cbiAgPEFkIGlkPVwiMWIzMzBlNTktM2E2Mi00MDAwLWI5ZmItYWM5NzI2ZTk4YzUyXCIgc2VxdWVuY2U9XCIxXCI+XG4gICAgPEluTGluZT5cbiAgICAgIDxBZFN5c3RlbSB2ZXJzaW9uPVwiMi4wXCI+bmVuZDwvQWRTeXN0ZW0+XG4gICAgICA8QWRUaXRsZT48IVtDREFUQVvjgrnjg57jg7zjg4jjg5Xjgqnjg7PjgqLjg4njg43jg4Pjg4jjg6/jg7zjgq/jgIxuZW5k44CNXV0+PC9BZFRpdGxlPlxuICAgICAgPERlc2NyaXB0aW9uPjwhW0NEQVRBW+mdmeatoueUu+ODkOODiuODvOOBi+OCieWLleeUu+ODquODr+ODvOODiS/li5XnlLvjgqTjg7Pjgr/jg7zjgrnjg4bjgqTjgrfjg6Pjg6sv5YuV55S744ON44Kk44OG44Kj44OW44Gr5a++5b+c44GX44Gm44GE44G+44GZXV0+PC9EZXNjcmlwdGlvbj5cbiAgICAgIDxBZHZlcnRpc2VyPjwhW0NEQVRBW+agquW8j+S8muekvuODleOCoeODs+OCs+ODn+ODpeODi+OCseODvOOCt+ODp+ODs+OCul1dPjwvQWR2ZXJ0aXNlcj5cbiAgICAgIDxFcnJvcj48IVtDREFUQVtodHRwczovL2lubGluZS50ZXN0LmV4YW1wbGUvZXJyb3I/Y29kZT1bRVJST1JDT0RFXSZjbGllbnRUaW1lPVtUSU1FU1RBTVBdXV0+PC9FcnJvcj5cbiAgICAgIDxJbXByZXNzaW9uIGlkPVwibmVuZFwiPjwhW0NEQVRBW2h0dHBzOi8vaW5saW5lLnRlc3QuZXhhbXBsZS9pbXByZXNzaW9uP2NsaWVudFRpbWU9W1RJTUVTVEFNUF1dXT48L0ltcHJlc3Npb24+XG4gICAgICA8Q3JlYXRpdmVzPlxuICAgICAgICA8Q3JlYXRpdmUgYWRJZD1cIjcyNDVcIiBzZXF1ZW5jZT1cIjFcIj5cbiAgICAgICAgICA8TGluZWFyPlxuICAgICAgICAgICAgPER1cmF0aW9uPjAwOjAwOjE1PC9EdXJhdGlvbj5cbiAgICAgICAgICAgIDxNZWRpYUZpbGVzPlxuICAgICAgICAgICAgICA8TWVkaWFGaWxlIGRlbGl2ZXJ5PVwicHJvZ3Jlc3NpdmVcIiB0eXBlPVwidmlkZW8vbXA0XCIgd2lkdGg9XCIxOTIwXCIgaGVpZ2h0PVwiMTA4MFwiPjwhW0NEQVRBW2h0dHBzOi8vczMtYXAtbm9ydGhlYXN0LTEuYW1hem9uYXdzLmNvbS9hZHN0aXItc3RhZ2UtanMvdmlkZW8vQWRTdGlyLU1PVklFLUpQLTE1Lm1wNF1dPjwvTWVkaWFGaWxlPlxuICAgICAgICAgICAgPC9NZWRpYUZpbGVzPlxuICAgICAgICAgICAgPFZpZGVvQ2xpY2tzPlxuICAgICAgICAgICAgICA8Q2xpY2tUaHJvdWdoPjwhW0NEQVRBW2h0dHBzOi8vbXQudW5pdGVkLmpwP2lzPXRlc3RdXT48L0NsaWNrVGhyb3VnaD5cbiAgICAgICAgICAgICAgPENsaWNrVHJhY2tpbmc+PCFbQ0RBVEFbaHR0cHM6Ly9pbmxpbmUudGVzdC5leGFtcGxlL3ZpZGVvY2xpY2t0cmFja2luZz9jbGllbnRUaW1lPVtUSU1FU1RBTVBdXV0+PC9DbGlja1RyYWNraW5nPlxuICAgICAgICAgICAgPC9WaWRlb0NsaWNrcz5cbiAgICAgICAgICAgIDxJY29ucz5cbiAgICAgICAgICAgICAgPEljb24gcHJvZ3JhbT1cIm5lbmRcIiB3aWR0aD1cIjEwXCIgaGVpZ2h0PVwiMTBcIiB4UG9zaXRpb249XCJyaWdodFwiIHlQb3NpdGlvbj1cInRvcFwiIG9mZnNldD1cIjAwOjAwOjA1XCIgZHVyYXRpb249XCIwMDowMDowNlwiPlxuICAgICAgICAgICAgICAgIDxTdGF0aWNSZXNvdXJjZSBjcmVhdGl2ZVR5cGU9XCJpbWFnZS9wbmdcIj48IVtDREFUQVtodHRwczovL3MzLWFwLW5vcnRoZWFzdC0xLmFtYXpvbmF3cy5jb20vYWRzdGlyLXN0YWdlLWpzL29wdG91dC9pMS5wbmddXT48L1N0YXRpY1Jlc291cmNlPlxuICAgICAgICAgICAgICAgIDxJY29uQ2xpY2tzPlxuICAgICAgICAgICAgICAgICAgPEljb25DbGlja1Rocm91Z2g+PCFbQ0RBVEFbaHR0cHM6Ly9qYS5hZC1zdGlyLmNvbS9zcC9vcHRvdXQuaHRtbF1dPjwvSWNvbkNsaWNrVGhyb3VnaD5cbiAgICAgICAgICAgICAgICA8L0ljb25DbGlja3M+XG4gICAgICAgICAgICAgIDwvSWNvbj5cbiAgICAgICAgICAgIDwvSWNvbnM+XG4gICAgICAgICAgICA8VHJhY2tpbmdFdmVudHM+XG4gICAgICAgICAgICAgIDxUcmFja2luZyBldmVudD1cInBhdXNlXCI+PCFbQ0RBVEFbaHR0cHM6Ly9pbmxpbmUudGVzdC5leGFtcGxlL3BhdXNlP2NsaWVudFRpbWU9W1RJTUVTVEFNUF1dXT48L1RyYWNraW5nPlxuICAgICAgICAgICAgICA8VHJhY2tpbmcgZXZlbnQ9XCJza2lwXCI+PCFbQ0RBVEFbaHR0cHM6Ly9pbmxpbmUudGVzdC5leGFtcGxlL3NraXA/Y2xpZW50VGltZT1bVElNRVNUQU1QXV1dPjwvVHJhY2tpbmc+XG4gICAgICAgICAgICAgIDxUcmFja2luZyBldmVudD1cInN0YXJ0XCI+PCFbQ0RBVEFbaHR0cHM6Ly9pbmxpbmUudGVzdC5leGFtcGxlL3N0YXJ0P2NsaWVudFRpbWU9W1RJTUVTVEFNUF1dXT48L1RyYWNraW5nPlxuICAgICAgICAgICAgICA8VHJhY2tpbmcgZXZlbnQ9XCJmaXJzdFF1YXJ0aWxlXCI+PCFbQ0RBVEFbaHR0cHM6Ly9pbmxpbmUudGVzdC5leGFtcGxlL2ZpcnN0UXVhcnRpbGU/Y2xpZW50VGltZT1bVElNRVNUQU1QXV1dPjwvVHJhY2tpbmc+XG4gICAgICAgICAgICAgIDxUcmFja2luZyBldmVudD1cIm1pZHBvaW50XCI+PCFbQ0RBVEFbaHR0cHM6Ly9pbmxpbmUudGVzdC5leGFtcGxlL21pZHBvaW50P2NsaWVudFRpbWU9W1RJTUVTVEFNUF1dXT48L1RyYWNraW5nPlxuICAgICAgICAgICAgICA8VHJhY2tpbmcgZXZlbnQ9XCJ0aGlyZFF1YXJ0aWxlXCI+PCFbQ0RBVEFbaHR0cHM6Ly9pbmxpbmUudGVzdC5leGFtcGxlL3RoaXJkUXVhcnRpbGU/Y2xpZW50VGltZT1bVElNRVNUQU1QXV1dPjwvVHJhY2tpbmc+XG4gICAgICAgICAgICAgIDxUcmFja2luZyBldmVudD1cImNvbXBsZXRlXCI+PCFbQ0RBVEFbaHR0cHM6Ly9pbmxpbmUudGVzdC5leGFtcGxlL2NvbXBsZXRlP2NsaWVudFRpbWU9W1RJTUVTVEFNUF1dXT48L1RyYWNraW5nPlxuICAgICAgICAgICAgICA8VHJhY2tpbmcgZXZlbnQ9XCJjb21wbGV0ZVwiPjwhW0NEQVRBW2h0dHBzOi8vaW5saW5lLnRlc3QuZXhhbXBsZS9jb21wbGV0ZTI/Y2xpZW50VGltZT1bVElNRVNUQU1QXV1dPjwvVHJhY2tpbmc+XG4gICAgICAgICAgICA8L1RyYWNraW5nRXZlbnRzPlxuICAgICAgICAgIDwvTGluZWFyPlxuICAgICAgICA8L0NyZWF0aXZlPlxuICAgICAgPC9DcmVhdGl2ZXM+XG4gICAgPC9JbkxpbmU+XG4gIDwvQWQ+XG48L1ZBU1Q+XG5gO1xuY2xhc3MgVmFzdEV4ZWN1dG9yIHtcbiAgICBzdGFydFBsYXllcihzb3VyY2VWYXN0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwic2V0UGxheWVyIHN0YXJ0ZWQuLi5cIik7XG4gICAgICAgIHNvdXJjZVZhc3QgPSBpbmxpbmVWYXN0U2FtcGxlO1xuICAgICAgICBjb25zdCB2YXN0T2JqZWN0ID0gdmFzdC5wYXJzZVZhc3Qoc291cmNlVmFzdCk7XG4gICAgICAgIGlmICghdmFzdE9iamVjdCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuICAgICAgICBpZnJhbWUud2lkdGggPSBcIjMwMHB4XCI7XG4gICAgICAgIGlmcmFtZS5oZWlnaHQgPSBcIjI1MHB4XCI7XG4gICAgICAgIGlmcmFtZS5zdHlsZS5ib3JkZXIgPSBcIm5vbmVcIjtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJib3hcIik/LmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gICAgICAgIGxldCBpRG9jID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gICAgICAgIGlEb2Mub3BlbigpO1xuICAgICAgICBpRG9jLndyaXRlKGNvbnRhaW5lcik7XG4gICAgICAgIGlEb2MuY2xvc2UoKTtcbiAgICAgICAgaURvYy5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuICAgICAgICBsZXQgYWRUaXRsZURpdiA9IGlEb2MuZ2V0RWxlbWVudEJ5SWQoXCJhZF90aXRsZVwiKTtcbiAgICAgICAgYWRUaXRsZURpdi50ZXh0Q29udGVudCA9IHZhc3RPYmplY3QuYWRUaXRsZTtcbiAgICAgICAgbGV0IHZhc3RWaWRlb0RpdiA9IGlEb2MuZ2V0RWxlbWVudEJ5SWQoXCJ2YXN0X3ZpZGVvXCIpO1xuICAgICAgICBsZXQgdmlkZW8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidmlkZW9cIik7XG4gICAgICAgIHZpZGVvLnNyYyA9IHZhc3RPYmplY3QubWVkaWFGaWxlVXJsO1xuICAgICAgICB2aWRlby5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xuICAgICAgICB2aWRlby5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcbiAgICAgICAgdmlkZW8ubXV0ZWQgPSB0cnVlO1xuICAgICAgICB2aWRlby5hdXRvcGxheSA9IHRydWU7XG4gICAgICAgIC8vIGxvYWRlZG1ldGFkYXRh44Kk44OZ44Oz44OI5b6M44Gn44Gq44GE44GoZHVyYXRpb27jgYzlj5bjgozjgarjgYRcbiAgICAgICAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRlZG1ldGFkYXRhXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBsZXQgcHJvZ3Jlc3NiYXIgPSBpRG9jLmdldEVsZW1lbnRCeUlkKFwicHJvZ3Jlc3NfYmFyXCIpO1xuICAgICAgICAgICAgbGV0IGJhckFuaW1hdGlvbkxvb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0IHByb2dyZXNzUG9pbnQgPSB2aWRlby5jdXJyZW50VGltZSAvIHZpZGVvLmR1cmF0aW9uICogMTAwO1xuICAgICAgICAgICAgICAgIHByb2dyZXNzYmFyLnN0eWxlLndpZHRoID0gcHJvZ3Jlc3NQb2ludCArIFwiJVwiO1xuICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShiYXJBbmltYXRpb25Mb29wKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYmFyQW5pbWF0aW9uTG9vcCk7XG4gICAgICAgIH0pO1xuICAgICAgICBzZXRCZWFjb25zKHZpZGVvLCB2YXN0T2JqZWN0KTtcbiAgICAgICAgc2V0SWNvbnModmlkZW8sIHZhc3RWaWRlb0RpdiwgdmFzdE9iamVjdCk7XG4gICAgICAgIHZhc3RWaWRlb0Rpdi5hcHBlbmRDaGlsZCh2aWRlbyk7XG4gICAgfVxufVxuY29uc3QgdmFzdEV4ZWN1dG9yID0gbmV3IFZhc3RFeGVjdXRvcigpO1xud2luZG93LnZhc3RFeGVjdXRvciA9IHdpbmRvdy52YXN0RXhlY3V0b3IgfHwgdmFzdEV4ZWN1dG9yO1xuIiwiaW1wb3J0IHsgY3JlYXRlQmVhY29uIH0gZnJvbSBcIi4vYmVhY29uXCI7XG5leHBvcnQgZnVuY3Rpb24gc2V0SWNvbnModmlkZW8sIGljb25QYXJlbnQsIHZhc3RPYmplY3QpIHtcbiAgICBmb3IgKGxldCBpY29uT2JqIG9mIHZhc3RPYmplY3QuaWNvbnMpIHtcbiAgICAgICAgbGV0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICAgICAgICBpY29uLnNyYyA9IGljb25PYmouaW1nVXJsO1xuICAgICAgICBpY29uLndpZHRoID0gaWNvbk9iai53aWR0aDtcbiAgICAgICAgaWNvbi5oZWlnaHQgPSBpY29uT2JqLmhlaWdodDtcbiAgICAgICAgaWNvbi5zdHlsZS5wb3NpdGlvbiA9IFwiZml4ZWRcIjtcbiAgICAgICAgaWYgKGljb25PYmoueFBvc2l0aW9uID09PSBcImxlZnRcIikge1xuICAgICAgICAgICAgaWNvbi5zdHlsZS5sZWZ0ID0gXCIwcHhcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpY29uT2JqLnhQb3NpdGlvbiA9PT0gXCJyaWdodFwiKSB7XG4gICAgICAgICAgICBpY29uLnN0eWxlLnJpZ2h0ID0gXCIwcHhcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGljb24uc3R5bGUubGVmdCA9IGljb25PYmoueFBvc2l0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpY29uT2JqLnlQb3NpdGlvbiA9PT0gXCJ0b3BcIikge1xuICAgICAgICAgICAgaWNvbi5zdHlsZS50b3AgPSBcIjBweFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGljb25PYmoueVBvc2l0aW9uID09PSBcImJvdHRvbVwiKSB7XG4gICAgICAgICAgICBpY29uLnN0eWxlLmJvdHRvbSA9IFwiMHB4XCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpY29uLnN0eWxlLnRvcCA9IGljb25PYmoueVBvc2l0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoaWNvbk9iai5jbGlja1RyYWNraW5nVXJsKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQmVhY29uKHZpZGVvLCBpY29uT2JqLmNsaWNrVHJhY2tpbmdVcmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGljb25PYmouY2xpY2tUaHJvdWdodFVybCkge1xuICAgICAgICAgICAgICAgIG9wZW4oaWNvbk9iai5jbGlja1Rocm91Z2h0VXJsLCBcIl9ibGFua1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJ0aW1ldXBkYXRlXCIsIGZ1bmN0aW9uIHRpbWVJY29uRXZlbnQoZSkge1xuICAgICAgICAgICAgaWYgKCFpY29uUGFyZW50LmNvbnRhaW5zKGljb24pICYmIHZpZGVvLmN1cnJlbnRUaW1lID49IGljb25PYmouc3RhcnQpIHtcbiAgICAgICAgICAgICAgICBpY29uUGFyZW50LmFwcGVuZENoaWxkKGljb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGljb25PYmouZW5kICYmIGljb25QYXJlbnQuY29udGFpbnMoaWNvbikgJiYgdmlkZW8uY3VycmVudFRpbWUgPj0gaWNvbk9iai5lbmQpIHtcbiAgICAgICAgICAgICAgICBpY29uUGFyZW50LnJlbW92ZUNoaWxkKGljb24pO1xuICAgICAgICAgICAgICAgIHZpZGVvLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0aW1ldXBkYXRlXCIsIHRpbWVJY29uRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOlsiY29udmVydFRpbWVUb1NlY29uZCIsImR1cmF0aW9uU3RyIiwicmVzdWx0IiwibWF0Y2giLCJsZW5ndGgiLCJOYU4iLCJwYXJzZUludCIsIkVycm9yIiwicGFyc2VGbG9hdCIsImNyZWF0ZUJlYWNvbiIsInBhcmVudCIsInVybCIsImRhdGUiLCJEYXRlIiwiZWxlIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic3JjIiwicmVwbGFjZSIsInRvSVNPU3RyaW5nIiwic3R5bGUiLCJkaXNwbGF5IiwicHJlcGVuZCIsImNvbnNvbGUiLCJsb2ciLCJzZW5kRXJyb3IiLCJ1cmxzIiwiZXJyb3JDb2RlIiwidG9TdHJpbmciLCJib2R5IiwiRXJyb3JDb2RlIiwiVFJBQ0tJTkdfRVZFTlRfUE9JTlQiLCJNYXAiLCJlcnJvclVybHMiLCJjb25zdHJ1Y3RvciIsInRoaXMiLCJwYXJzZVZhc3QiLCJzb3VyY2VWYXN0IiwidmFzdERvYyIsInBhcnNlVmFzdFhNTCIsImNyZWF0ZVZhc3RPYmplY3QiLCJlIiwieG1sRG9jIiwiRE9NUGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwicGFyc2VyRXJyb3IiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJ2ZG9jIiwicm9vdEVycm9yRG9jIiwicHVzaCIsImlubGluZURvYyIsIk5vVkFTVFJlc3BvbnNlQWZ0ZXJXcmFwcGVyIiwiZXJyb3JEb2MiLCJYTUxQYXJzZUVycm9yIiwiaW1wRG9jIiwiaW1wcmVzc2lvblVybCIsImFkVGl0bGVEb2MiLCJhZFRpdGxlIiwibGluZWFyRG9jIiwiZHVyYXRpb25Eb2MiLCJkdXJhdGlvbiIsInRyYWNraW5nc0RvYyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0cmFja2luZ01hcCIsImNyZWF0ZVRyYWNraW5nT2JqZWN0IiwiaWNvbnNEb2MiLCJpY29uT2JqZWN0cyIsImNyZWF0ZUljb25PYmplY3QiLCJtZWRpYUZpbGVzRG9jIiwibWVkaWFGaWxlVXJsIiwiY2xpY2tUaHJvdWdoRG9jIiwiY2xpY2tUaHJvdWdoVXJsIiwiaW1wcmVzc2lvblVybHMiLCJ0cmFja2luZ3MiLCJpY29ucyIsImZvckVhY2giLCJ0cmFja2luZyIsImV2ZW50IiwiZ2V0QXR0cmlidXRlIiwib2Zmc2V0Iiwib2Zmc2V0U2Vjb25kIiwic2V0IiwiZXZlbnRfcG9pbnQiLCJnZXQiLCJ1bmRlZmluZWQiLCJpY29uIiwiaWNvbkVsZSIsIndpZHRoIiwiaGVpZ2h0IiwieCIsInhQb3NpdGlvbiIsInkiLCJ5UG9zaXRpb24iLCJzdGFydCIsImVuZCIsInN0YXRpY1Jlc291cmNlIiwiaWNvbkNsaWNrVGhyb3VnaCIsImljb25DbGlja1RyYWNraW5nIiwiaW1nVXJsIiwiY2xpY2tUaHJvdWdodFVybCIsImNsaWNrVHJhY2tpbmdVcmwiLCJ2YXN0RXhlY3V0b3IiLCJzdGFydFBsYXllciIsInZhc3RPYmplY3QiLCJpZnJhbWUiLCJib3JkZXIiLCJnZXRFbGVtZW50QnlJZCIsImFwcGVuZENoaWxkIiwiaURvYyIsImNvbnRlbnRXaW5kb3ciLCJvcGVuIiwid3JpdGUiLCJjbG9zZSIsImRvY3VtZW50RWxlbWVudCIsIm92ZXJmbG93IiwidmFzdFZpZGVvRGl2IiwidmlkZW8iLCJtdXRlZCIsImF1dG9wbGF5IiwiYWRkRXZlbnRMaXN0ZW5lciIsInByb2dyZXNzYmFyIiwiYmFyQW5pbWF0aW9uTG9vcCIsInByb2dyZXNzUG9pbnQiLCJjdXJyZW50VGltZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm9uY2UiLCJzZXRJbXByZXNzaW9uVXJsIiwic2V0VmlkZW9DbGlja1Rocm91Z2hVcmwiLCJwb2ludCIsInRpbWVCZWFjb25FdmVudCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRUcmFja2luZ1VybHMiLCJzZXRCZWFjb25zIiwiaWNvblBhcmVudCIsImljb25PYmoiLCJwb3NpdGlvbiIsImxlZnQiLCJyaWdodCIsInRvcCIsImJvdHRvbSIsInRpbWVJY29uRXZlbnQiLCJjb250YWlucyIsInJlbW92ZUNoaWxkIiwic2V0SWNvbnMiLCJ3aW5kb3ciXSwic291cmNlUm9vdCI6IiJ9